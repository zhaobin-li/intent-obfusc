Running mongod with env db
LOG_DIR: /scratch/zl430/fiftyone/randomized/35147728_399
RND_PT: 53981
about to fork child process, waiting until server is ready for connections.
forked process: 121291
child process started successfully, parent exiting

Running pytorch with env coco
Migrating database to v0.23.2
2024-03-13 03:13:34,750 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - INFO - Config (path: configs/mislabel_bbox_ssd_512.py): {'model_config': '../mmdetection/configs/ssd/ssd512_coco.py', 'model_checkpoint': '../mmdetection/checkpoints/ssd512_coco_20210803_022849-0a47a1ca.pth', 'dataset_name': 'itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512_coco', 'images_path': '../coco/val2017', 'labels_path': '../coco/annotations/instances_val2017.json', 'gt_samples': 5000, 'attack_samples': 200, 'shuffle': True, 'seed': 31148, 'replace_dataset': True, 'compute_map': False, 'cuda': 0, 'launch_app': False, 'itr': 200, 'max_norm': 0.05, 'min_iou': 0.3, 'min_score': 0.3, 'non_overlap': True, 'attack_bbox': 'predictions', 'adversarial_target': 'mislabel', 'perturb_fun': 'perturb_inside', 'arbitrary_bbox': False, 'criteria_dt': {'target_max_conf': None, 'perturb_min_size': None, 'bbox_max_dist': None}, 'result_dir': './data/randomized/results', 'dataset_dir': './data/randomized/datasets', 'cache_dir': './data/randomized/caches', 'log_dir': './data/randomized/logs', 'img_dir': './data/randomized/images', 'viz_pgd': False, 'log_level': 'DEBUG', 'backward_loss': 'get_ssd_512_mislabel_loss', 'log_name': 'itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512'}
2024-03-13 03:13:34,751 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - {
    "batcher_static_size": 100,
    "batcher_target_latency": 0.2,
    "batcher_target_size_bytes": 1048576,
    "bulk_write_batch_size": 100000,
    "database_admin": true,
    "database_dir": "/home/zl430/.fiftyone/var/lib/mongo",
    "database_name": "fiftyone",
    "database_uri": "mongodb://127.0.0.1:53981/",
    "database_validation": true,
    "dataset_zoo_dir": "/home/zl430/fiftyone",
    "dataset_zoo_manifest_paths": null,
    "default_app_address": "localhost",
    "default_app_port": 5151,
    "default_batch_size": null,
    "default_batcher": "latency",
    "default_dataset_dir": "/home/zl430/fiftyone",
    "default_image_ext": ".jpg",
    "default_ml_backend": "torch",
    "default_sequence_idx": "%06d",
    "default_video_ext": ".mp4",
    "desktop_app": false,
    "do_not_track": false,
    "logging_level": "INFO",
    "max_process_pool_workers": null,
    "max_thread_pool_workers": null,
    "model_zoo_dir": "/home/zl430/fiftyone/__models__",
    "model_zoo_manifest_paths": null,
    "module_path": null,
    "operator_timeout": 600,
    "plugins_cache_enabled": false,
    "plugins_dir": "/home/zl430/fiftyone/__plugins__",
    "requirement_error_level": 0,
    "show_progress_bars": true,
    "timezone": null
}
Importing samples...
   0% ||----|    1/4914 [1.8ms elapsed, 8.6s remaining, 568.9 samples/s]                                                                            21% |█/---| 1023/4914 [115.7ms elapsed, 440.2ms remaining, 8.8K samples/s]                                                                                42% |██---| 2047/4914 [407.0ms elapsed, 570.1ms remaining, 5.0K samples/s]                                                                                56% |██\--| 2750/4914 [621.1ms elapsed, 488.8ms remaining, 4.4K samples/s]                                                                                96% |████|| 4721/4914 [832.7ms elapsed, 34.0ms remaining, 5.7K samples/s]                                                                                100% |█████| 4914/4914 [852.0ms elapsed, 0s remaining, 5.8K samples/s]      
Import complete
2024-03-13 03:13:37,381 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - INFO - Imported cache_name='./data/randomized/caches/ssd512_coco_20210803_022849-0a47a1ca'!
2024-03-13 03:13:37,389 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Name:        itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512_coco
Media type:  image
Num samples: 4914
Persistent:  False
Tags:        []
Sample fields:
    id:           fiftyone.core.fields.ObjectIdField
    filepath:     fiftyone.core.fields.StringField
    tags:         fiftyone.core.fields.ListField(fiftyone.core.fields.StringField)
    metadata:     fiftyone.core.fields.EmbeddedDocumentField(fiftyone.core.metadata.ImageMetadata)
    ground_truth: fiftyone.core.fields.EmbeddedDocumentField(fiftyone.core.labels.Detections)
    predictions:  fiftyone.core.fields.EmbeddedDocumentField(fiftyone.core.labels.Detections)
    eval_tp:      fiftyone.core.fields.IntField
    eval_fp:      fiftyone.core.fields.IntField
    eval_fn:      fiftyone.core.fields.IntField
2024-03-13 03:13:37,405 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - INFO - dataset.name='itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512_coco'
load checkpoint from local path: ../mmdetection/checkpoints/ssd512_coco_20210803_022849-0a47a1ca.pth
2024-03-13 03:13:38,704 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - SingleStageDetector(
  (backbone): SSDVGG(
    (features): Sequential(
      (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): ReLU(inplace=True)
      (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (3): ReLU(inplace=True)
      (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=True)
      (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (6): ReLU(inplace=True)
      (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (8): ReLU(inplace=True)
      (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=True)
      (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (11): ReLU(inplace=True)
      (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (13): ReLU(inplace=True)
      (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (15): ReLU(inplace=True)
      (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=True)
      (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (18): ReLU(inplace=True)
      (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (20): ReLU(inplace=True)
      (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (22): ReLU(inplace=True)
      (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=True)
      (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (25): ReLU(inplace=True)
      (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (27): ReLU(inplace=True)
      (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (29): ReLU(inplace=True)
      (30): MaxPool2d(kernel_size=3, stride=1, padding=1, dilation=1, ceil_mode=False)
      (31): Conv2d(512, 1024, kernel_size=(3, 3), stride=(1, 1), padding=(6, 6), dilation=(6, 6))
      (32): ReLU(inplace=True)
      (33): Conv2d(1024, 1024, kernel_size=(1, 1), stride=(1, 1))
      (34): ReLU(inplace=True)
    )
  )
  init_cfg={'type': 'Pretrained', 'checkpoint': 'open-mmlab://vgg16_caffe'}
  (neck): SSDNeck(
    (l2_norm): L2Norm()
    (extra_layers): ModuleList(
      (0): Sequential(
        (0): ConvModule(
          (conv): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1))
          (activate): ReLU(inplace=True)
        )
        (1): ConvModule(
          (conv): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (activate): ReLU(inplace=True)
        )
      )
      (1): Sequential(
        (0): ConvModule(
          (conv): Conv2d(512, 128, kernel_size=(1, 1), stride=(1, 1))
          (activate): ReLU(inplace=True)
        )
        (1): ConvModule(
          (conv): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (activate): ReLU(inplace=True)
        )
      )
      (2): Sequential(
        (0): ConvModule(
          (conv): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
          (activate): ReLU(inplace=True)
        )
        (1): ConvModule(
          (conv): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (activate): ReLU(inplace=True)
        )
      )
      (3): Sequential(
        (0): ConvModule(
          (conv): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
          (activate): ReLU(inplace=True)
        )
        (1): ConvModule(
          (conv): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
          (activate): ReLU(inplace=True)
        )
      )
      (4): Sequential(
        (0): ConvModule(
          (conv): Conv2d(256, 128, kernel_size=(1, 1), stride=(1, 1))
          (activate): ReLU(inplace=True)
        )
        (1): ConvModule(
          (conv): Conv2d(128, 256, kernel_size=(4, 4), stride=(1, 1), padding=(1, 1))
          (activate): ReLU(inplace=True)
        )
      )
    )
  )
  init_cfg=[{'type': 'Xavier', 'distribution': 'uniform', 'layer': 'Conv2d'}, {'type': 'Constant', 'val': 1, 'layer': 'BatchNorm2d'}, {'type': 'Constant', 'val': 20, 'override': {'name': 'l2_norm'}}]
  (bbox_head): SSDHead(
    (cls_convs): ModuleList(
      (0): Sequential(
        (0): Conv2d(512, 324, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (1): Sequential(
        (0): Conv2d(1024, 486, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (2): Sequential(
        (0): Conv2d(512, 486, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (3): Sequential(
        (0): Conv2d(256, 486, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (4): Sequential(
        (0): Conv2d(256, 486, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (5): Sequential(
        (0): Conv2d(256, 324, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (6): Sequential(
        (0): Conv2d(256, 324, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
    )
    (reg_convs): ModuleList(
      (0): Sequential(
        (0): Conv2d(512, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (1): Sequential(
        (0): Conv2d(1024, 24, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (2): Sequential(
        (0): Conv2d(512, 24, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (3): Sequential(
        (0): Conv2d(256, 24, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (4): Sequential(
        (0): Conv2d(256, 24, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (5): Sequential(
        (0): Conv2d(256, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
      (6): Sequential(
        (0): Conv2d(256, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
    )
  )
  init_cfg={'type': 'Xavier', 'layer': 'Conv2d', 'distribution': 'uniform', 'bias': 0}
)
2024-03-13 03:13:38,706 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - INFO - classes=['person', 'bicycle', 'car', 'motorcycle', 'airplane', 'bus', 'train', 'truck', 'boat', 'traffic light', 'fire hydrant', 'stop sign', 'parking meter', 'bench', 'bird', 'cat', 'dog', 'horse', 'sheep', 'cow', 'elephant', 'bear', 'zebra', 'giraffe', 'backpack', 'umbrella', 'handbag', 'tie', 'suitcase', 'frisbee', 'skis', 'snowboard', 'sports ball', 'kite', 'baseball bat', 'baseball glove', 'skateboard', 'surfboard', 'tennis racket', 'bottle', 'wine glass', 'cup', 'fork', 'knife', 'spoon', 'bowl', 'banana', 'apple', 'sandwich', 'orange', 'broccoli', 'carrot', 'hot dog', 'pizza', 'donut', 'cake', 'chair', 'couch', 'potted plant', 'bed', 'dining table', 'toilet', 'tv', 'laptop', 'mouse', 'remote', 'keyboard', 'cell phone', 'microwave', 'oven', 'toaster', 'sink', 'refrigerator', 'book', 'clock', 'vase', 'scissors', 'teddy bear', 'hair drier', 'toothbrush']
2024-03-13 03:13:38,711 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - lower_bound.squeeze()=tensor([-123.6750, -116.2800, -103.5300], device='cuda:0'), upper_bound.squeeze()=tensor([131.3250, 138.7200, 151.4700], device='cuda:0'), normalized_range.squeeze()=tensor([255.0000, 255.0000, 255.0000], device='cuda:0')
2024-03-13 03:13:38,711 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - INFO - eval
2024-03-13 03:13:38,711 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Dataset:     itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512_coco
Media type:  image
Num samples: 3651
Sample fields:
    id:           fiftyone.core.fields.ObjectIdField
    filepath:     fiftyone.core.fields.StringField
    tags:         fiftyone.core.fields.ListField(fiftyone.core.fields.StringField)
    metadata:     fiftyone.core.fields.EmbeddedDocumentField(fiftyone.core.metadata.ImageMetadata)
    ground_truth: fiftyone.core.fields.EmbeddedDocumentField(fiftyone.core.labels.Detections)
    predictions:  fiftyone.core.fields.EmbeddedDocumentField(fiftyone.core.labels.Detections)
    eval_tp:      fiftyone.core.fields.IntField
    eval_fp:      fiftyone.core.fields.IntField
    eval_fn:      fiftyone.core.fields.IntField
View stages:
    1. Match(filter={'$expr': {'$gte': [...]}})
2024-03-13 03:13:38,743 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - INFO - len(min_correct_slice)=3651
2024-03-13 03:13:38,744 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - INFO - Starting attack itr=200, lr.squeeze()=tensor([1.2750, 1.2750, 1.2750], device='cuda:0')
2024-03-13 03:13:38,785 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:13:38,801 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:13:38,815 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:13:38,840 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:13:49,233 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:15:24,947 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:15:54,464 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:16:04,394 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:16:04,407 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:16:34,107 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:16:44,273 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:16:44,284 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:17:13,824 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:17:13,840 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:17:43,529 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:17:43,541 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:19:00,354 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:19:10,003 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:19:10,018 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:20:07,686 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:20:36,716 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:21:35,895 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:21:45,746 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:21:45,758 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:23:53,370 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:24:12,589 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:25:00,571 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:25:19,830 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:26:46,534 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:28:22,745 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:28:51,758 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:28:51,793 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:28:51,831 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:29:30,239 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:29:59,090 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:29:59,121 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:30:18,572 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:30:47,482 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:31:16,391 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
2024-03-13 03:31:16,444 - itr_200_norm_0.05_repeat_7_mislabel_bbox_ssd_512 - DEBUG - Ignoring sample since no bbox pairs are eligible
